@using KCC.Web.Features.Ssr
@using Microsoft.AspNetCore.Hosting
@using Microsoft.Extensions.Hosting

@inject IWebHostEnvironment Env
@inject VueSsrService VueSsrService

@model BasePageViewModel

<!DOCTYPE html>
<html lang="en">

<head>
  <partial name="~/Features/Pages/Shared/Partials/Metadata.cshtml" />

  @* Preload critical fonts to speed up initial render *@
  <link rel="preload" href="/fonts/HazelnutMilkTeaRegular.woff2" as="font" type="font/woff2" crossorigin />
  <link rel="preload" href="/fonts/AmericanPurposeCasualRegular.woff2" as="font" type="font/woff2" crossorigin />

  @if (Env.IsDevelopment())
  {
    @* In dev: Tailwind CLI watches and outputs CSS here (run yarn dev:css) *@
    <link rel="stylesheet" href="/assets/main-dev.css" />
  }
  <link rel="stylesheet" vite-href="/Features/Main.ts" asp-append-version="true" />
  <page-builder-styles />
</head>

<body>
  @await VueSsrService.RenderVueSsrAsync(
    await Component.InvokeAsync("Header"),
    RenderBody(),
    await Component.InvokeAsync("Footer"),
    Context.RequestAborted
  )

  <script type="module" vite-src="/Features/Main.ts" asp-append-version="true"></script>
  <page-builder-scripts />
</body>

</html>
